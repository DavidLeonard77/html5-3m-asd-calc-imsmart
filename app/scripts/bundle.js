!function t(e,n,i){function o(c,a){if(!n[c]){if(!e[c]){var s="function"==typeof require&&require;if(!a&&s)return s(c,!0);if(r)return r(c,!0);var u=new Error("Cannot find module '"+c+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[c]={exports:{}};e[c][0].call(l.exports,function(t){var n=e[c][1][t];return o(n?n:t)},l,l.exports,t,e,n,i)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<i.length;c++)o(i[c]);return o}({1:[function(t,e,n){"use strict";angular.module("3m-asd",["ionic","ngCordova","ngResource","LocalStorageModule","ui.utils.masks"]).run(["$ionicPlatform","$rootScope","$timeout","ConfigService","SQLService","FilterService","ProductService","ImageService",function(t,e,n,i,o,r,c,a){t.ready(function(){e.macsAlive=!1,macs.initApi(function(){e.macsAlive=!0}),n(function(){i.init().then(function(){o.initDB().then(function(){a.init().then(function(){c.init().then(function(){r.init().then(function(){e.$broadcast("app-ready")})})})})})},200)})}]).config(["$httpProvider","$stateProvider","$urlRouterProvider","localStorageServiceProvider",function(t,e,n,i){i.setPrefix("mmm-product-selector-gd13bd7").setStorageType("localStorage").setNotify(!0,!0),e.state("tab",{url:"/tab","abstract":!0,templateUrl:"templates/tabs.html"}).state("tab.products",{url:"/products",views:{products:{templateUrl:"templates/views/products.html",controller:"ProductsCtrl"}}}).state("tab.substrates",{url:"/substrates",views:{substrates:{templateUrl:"templates/views/substrates.html",controller:"SubstratesCtrl"}}}).state("tab.machines",{url:"/machines",views:{machines:{templateUrl:"templates/views/machines.html",controller:"MachinesCtrl"}}}).state("tab.applications",{url:"/applications",views:{applications:{templateUrl:"templates/views/applications.html",controller:"ApplicationsCtrl"}}}).state("tab.summary",{url:"/summary",cache:!1,views:{summary:{templateUrl:"templates/views/summary.html",controller:"SummaryCtrl"}}}).state("tab.details",{url:"/details?product",cache:!1,views:{details:{templateUrl:"templates/views/details.html",controller:"DetailsCtrl"}}}).state("tab.settings",{url:"/settings",views:{settings:{templateUrl:"templates/views/settings.html",controller:"SettingsCtrl"}}}).state("tab.reset",{url:"/reset",cache:!1,views:{reset:{templateUrl:"templates/views/reset.html",controller:"ResetCtrl"}}}),n.otherwise("/tab/products")}]).controller("MainCtrl",t("./controllers/mainController")).controller("ProductsCtrl",t("./controllers/productsController")).controller("SubstratesCtrl",t("./controllers/substratesController")).controller("MachinesCtrl",t("./controllers/machinesController")).controller("ApplicationsCtrl",t("./controllers/applicationsController")).controller("SummaryCtrl",t("./controllers/summaryController")).controller("DetailsCtrl",t("./controllers/detailsController")).controller("SettingsCtrl",t("./controllers/settingsController")).controller("ResetCtrl",t("./controllers/resetController")).directive("cnCheckbox",t("./directives/cnCheckbox")).factory("ConfigService",t("./services/ConfigService")).factory("PDFService",t("./services/PDFService")).factory("FileService",t("./services/FileService")).factory("AssetService",t("./services/AssetService")).factory("SQLService",t("./services/SQLService")).factory("SelectorService",t("./services/SelectorService")).factory("FilterService",t("./services/FilterService")).factory("ProductService",t("./services/ProductService")).factory("ImageService",t("./services/ImageService")).factory("SettingsService",t("./services/SettingsService"))},{"./controllers/applicationsController":2,"./controllers/detailsController":3,"./controllers/machinesController":4,"./controllers/mainController":5,"./controllers/productsController":6,"./controllers/resetController":7,"./controllers/settingsController":8,"./controllers/substratesController":9,"./controllers/summaryController":10,"./directives/cnCheckbox":11,"./services/AssetService":12,"./services/ConfigService":13,"./services/FileService":14,"./services/FilterService":15,"./services/ImageService":16,"./services/PDFService":17,"./services/ProductService":18,"./services/SQLService":19,"./services/SelectorService":20,"./services/SettingsService":21}],2:[function(t,e,n){"use strict";e.exports=["$rootScope","$scope","$state","$timeout","$ionicPopover","FilterService","ConfigService",function(t,e,n,i,o,r,c){function a(){e.data=r.fetch(["applications","choices"]),e.config=c.fetch("config").views.applications,e.config.tip=c.fetch("config").popups.tip}function s(){r.inited()?a():e.$on("app-ready",function(){i(a())})}e.data={},o.fromTemplateUrl("templates/popovers/tip.html",{scope:e}).then(function(t){e.tip=t}),e.tipped={},e.openTip=function(t,n){n.available&&(e.tipped.item=n.title,e.data.tooltip=n,e.tip.show(t))},e.closeTip=function(){e.tip.hide()},e.$on("popover.hidden",function(){e.tipped.item=null}),e.select=function(o){o.available&&(t.$broadcast("updateTabsRefresh"),o.selected?(o.selected=!1,e.data.choices.application=null,e.data.choices.selection=null,r.update()):(e.data.choices.application=o,angular.forEach(e.data.applications.items,function(t){t.selected=o.index===t.index}),r.update(),i(function(){e.choices.product?e.choices.substrate?e.choices.machine?n.go("tab.summary"):n.go("tab.machines"):n.go("tab.substrates"):n.go("tab.products")},300)))},e.go=function(t){n.go(t)},s()}]},{}],3:[function(t,e,n){"use strict";e.exports=["$scope","$state","$stateParams","$ionicPopover","$compile","$timeout","ProductService","FilterService","AssetService","PDFService","ConfigService",function(t,e,n,i,o,r,c,a,s,u,l){function f(){t.product.assets=[],t.product.selectedAssets=[];var e=[];angular.forEach(["literature_0","literature_1","literature_2","literature_3","literature_4","literature_5","literature_6","video_1","video_2","safety_insert"],function(n){t.product[n]&&e.push(t.product[n].toString())}),s.getSegmentAssets(e).then(function(e){t.product.assets=e})}function p(){return t.product.assets.filter(function(t){return t.checked})}function d(){t.data=a.fetch(["selections","settings"]),t.product=c.getProduct(n.product),t.config=l.fetch("config").views.details,t.config.share=l.fetch("config").popups.share,t.folders={selected:1},f()}function m(){a.inited()?d():t.$on("app-ready",function(){r(d())})}var h=!1;t.email=function(){h=!0,t.product.selectedAssets=p(),u.compileHTML(t,{templatePath:"templates/email.html"}).then(function(e){var n=document.getElementsByTagName("link")[0].href;u.emailPDF(t,{subject:"3M Sales Representative Recommended Product Information",message:e,to:"",cc:"",bcc:""},{title:"Your 3M Product Recommendations",templatePath:"templates/pdf.html",cssPath:n}).then(function(){h=!1},function(){})})},t.save=function(){var e=document.getElementsByTagName("link")[0].href,n={title:"Your 3M Product Recommendations",templatePath:"templates/pdf.html",cssPath:e};u.savePDF(t,n).then(function(){},function(){})},i.fromTemplateUrl("templates/popovers/share.html",{scope:t}).then(function(e){t.share=e}),t.openShare=function(e){t.share.show(e)},t.closePopover=function(){t.share.hide()},t.$on("$destroy",function(){t.share.remove()}),t.go=function(t){e.go(t)},t.viewAsset=function(t){macs.viewAsset(t,function(){})},t.checkboxUpdate=function(){console.log("checkbox clicked")},m()}]},{}],4:[function(t,e,n){"use strict";e.exports=["$scope","$state","$rootScope","$timeout","FilterService","ConfigService",function(t,e,n,i,o,r){function c(){t.data=o.fetch(["machines","choices"]),t.config=r.fetch("config").views.machines}function a(){o.inited()?c():t.$on("app-ready",function(){i(c())})}t.data={},t.select=function(r){r.available&&(n.$broadcast("updateTabsRefresh"),r.selected?(r.selected=!1,t.data.choices.machine=null,t.data.choices.selection=null,o.update()):(t.data.choices.machine=r,angular.forEach(t.data.machines.items,function(t){t.selected=r.index===t.index}),o.update(),i(function(){t.choices.product?t.choices.substrate?t.choices.application?e.go("tab.summary"):e.go("tab.applications"):e.go("tab.substrates"):e.go("tab.products")},300)))},t.go=function(t){e.go(t)},a()}]},{}],5:[function(t,e,n){"use strict";e.exports=["$scope","$rootScope","$timeout","$ionicPopup","FilterService","ConfigService",function(t,e,n,i,o,r){function c(){t.choices=o.fetch("choices");var e=r.fetch("config").views.tabs,n=["products","substrates","machines","applications","summary","details","settings","reset"];t.tabs={},angular.forEach(n,function(n,i){t.tabs[n]={title:e.tab[i],disabled:!1}})}function a(){o.inited()?c():t.$on("app-ready",function(){n(c())})}a();var s=e.$on("updateTabsRefresh",function(){n(function(){t.tabs.summary.disabled=t.choices.product&&t.choices.substrate&&t.choices.machine&&t.choices.application,t.tabs.details.disabled=t.tabs.summary&&t.choices.selection})});t.$on("$destroy",function(){s()})}]},{}],6:[function(t,e,n){"use strict";e.exports=["$scope","$state","$rootScope","$timeout","FilterService","ConfigService",function(t,e,n,i,o,r){function c(){t.data=o.fetch(["products","choices"]),t.config=r.fetch("config").views.products}function a(){o.inited()?c():t.$on("app-ready",function(){i(c())})}t.data={},t.select=function(r){r.available&&(n.$broadcast("updateTabsRefresh"),r.selected?(r.selected=!1,t.data.choices.product=null,t.data.choices.selection=null,o.update()):(t.data.choices.product=r,angular.forEach(t.data.products.items,function(t){t.selected=r.index===t.index}),o.update(),i(function(){t.choices.substrate?t.choices.machines?t.choices.application?e.go("tab.summary"):e.go("tab.applications"):e.go("tab.machines"):e.go("tab.substrates")},300)))},t.go=function(t){e.go(t)},a()}]},{}],7:[function(t,e,n){"use strict";e.exports=["$scope","$state","$timeout","$rootScope","FilterService","ConfigService",function(t,e,n,i,o,r){function c(){t.data=o.fetch(["products","substrates","machines","applications","choices"]),t.config=r.fetch("config").views.reset,angular.forEach(t.data,function(t){angular.forEach(t.items,function(t){t.selected=!1,t.available=!0})}),angular.forEach(t.data.choices,function(e,n){t.data.choices[n]=null}),i.$broadcast("updateTabsRefresh"),n(function(){e.go("tab.products")})}function a(){o.inited()?c():t.$on("app-ready",function(){n(c())})}a()}]},{}],8:[function(t,e,n){"use strict";e.exports=["$scope","$state","$timeout","ConfigService","FilterService","SettingsService","localStorageService",function(t,e,n,i,o,r,c){function a(){t.settings=r.getSettings("settings"),t.config=i.fetch("config").views.settings}function s(){o.inited()?a():t.$on("app-ready",function(){n(a())})}t.go=function(t){e.go(t)},t.forms={},t.forms.focus=null,t.focused=function(e){t.forms.focus=e.srcElement.id},t.blurred=function(){t.forms.focus=null},t.saveSettings=function(){c.set("data",t.settings)},t.update=function(){t.saveSettings()},s()}]},{}],9:[function(t,e,n){"use strict";e.exports=["$scope","$state","$rootScope","$timeout","FilterService","ConfigService",function(t,e,n,i,o,r){function c(){t.data=o.fetch(["substrates","choices"]),t.config=r.fetch("config").views.substrates}function a(){o.inited()?c():t.$on("app-ready",function(){i(c())})}t.data={},t.select=function(r){r.available&&(n.$broadcast("updateTabsRefresh"),r.selected?(r.selected=!1,t.data.choices.substrate=null,t.data.choices.selection=null,o.update()):(t.data.choices.substrate=r,angular.forEach(t.data.substrates.items,function(t){t.selected=r.index===t.index}),o.update(),i(function(){t.choices.product?t.choices.machine?t.choices.application?e.go("tab.summary"):e.go("tab.applications"):e.go("tab.machines"):e.go("tab.products")},300)))},t.go=function(t){e.go(t)},a()}]},{}],10:[function(t,e,n){"use strict";e.exports=["$scope","$state","$rootScope","$timeout","FilterService","ConfigService",function(t,e,n,i,o,r){function c(e){angular.forEach(e,function(e){angular.forEach(t.data[e].items,function(n){if(n.available&&n.title){var i="";switch(e){case"recommended":i=t.config.label[1];break;case"alternative":i=t.config.label[2];break;case"general":i=t.config.label[3]}t.suggestions[e]={item:n,title:i}}})})}function a(){t.data=o.fetch(["recommended","alternative","general","choices"]),t.config=r.fetch("config").views.summary,t.suggestions={},c(["recommended","alternative","general"])}function s(){o.inited()?a():t.$on("app-ready",function(){i(a())})}t.choose=function(i){t.data.choices.selection=i,n.$broadcast("updateTabsRefresh"),e.go("tab.details",{product:i.item.part})},s()}]},{}],11:[function(t,e,n){"use strict";e.exports=[function(){return{restrict:"E",templateUrl:"templates/directives/cn-checkbox.html",scope:{label:"=",checked:"=",change:"="},link:function(t){t.update=function(){t.checked=!t.checked,t.change()}}}}]},{}],12:[function(t,e,n){"use strict";e.exports=["$q","FileService",function(t,e){var n=function(n){return t(function(t){n.length?macs.getOfflineLinksForAssets(n.join(),function(i){var o=[],r=0;angular.forEach(n,function(c){macs.getRequiredAssetDetails(c,["itemTypeId","title","fileType","iconImageName","itemDescription"],function(a){a.assetId=c,a.filePath=i[c],a.imagePath=e.getIcon(a.iconImageName,a.fileType),r++,o.push(a),r===n.length&&t(o)},function(){r++,r===n.length&&t(o)})})},function(){t()}):t()})};return{getSegmentAssets:n}}]},{}],13:[function(t,e,n){"use strict";e.exports=["$rootScope","$http","$timeout","$q",function(t,e,n,i){function o(t){return i(function(i,o){e({url:t,method:"GET"}).then(function(t){n(function(){i(t.data)})},function(t){o(t)})})}function r(t){var e,n=decodeURIComponent(location.search),i=n.split("?")[1],o=angular.fromJson(i),r={};return o&&(e=o.assetParams.split("&"),angular.forEach(e,function(t){var e=t.split("=");r[e[0]]=e[1]})),r[t]||null}function c(){return i(function(e,n){function i(){var t=d+"settings.txt";o(t).then(function(t){e(t)},function(t){n(t)})}if(t.macsAlive){var c=r("settingsAssetId");c?macs.getAssetPath(c,function(t){o(t.assetPath).then(function(t){e(t)},function(){i()})},function(){i()}):i()}else i()})}function a(){return i(function(e,n){function i(){var t="data/config_"+c+".txt";o(t).then(function(t){e(t)},function(t){n(t)})}var c=m;if(t.macsAlive){var a=r("configAssetId")||p.settings.language_code.setting;a?macs.getAssetPath(a,function(t){o(t.assetPath).then(function(t){e(t)},function(){i()})},function(){i()}):i()}else i()})}function s(){return f}function u(){return i(function(t,e){c().then(function(n){p.settings=n,a().then(function(e){p.config=e,f=!0,t()},function(){e()})},function(){e()})})}function l(t){if(angular.isArray(t)){var e={};return angular.forEach(t,function(t){e[t]=p[t]}),e}return p[t]}var f=!1,p={},d="data/",m="en_US";return{init:u,inited:s,params:r,fetch:l}}]},{}],14:[function(t,e,n){"use strict";e.exports=[function(){var t={PDF:"pdf",LINK:"weblink",VIDEO:"video",AUDIO:"audio",IMAGE:"image",CSV:"csv",EXCEL:"excel",PPT:"ppt",TEXT:"text",WORD:"word",ZIP:"app",BUY:"buy",EXTERNAL:"external",KEYNOTE:"keynote",EPUB:"epub",IBOOKS:"ibooks"},e=function(){var e={};return e.pdf=t.PDF,e.link=t.LINK,e.mp4=t.VIDEO,e.mpv=t.VIDEO,e["3gp"]=t.VIDEO,e.mov=t.VIDEO,e.m4v=t.VIDEO,e.aac=t.AUDIO,e.aif=t.AUDIO,e.aiff=t.AUDIO,e.aifc=t.AUDIO,e.caf=t.AUDIO,e.mp3=t.AUDIO,e.m4a=t.AUDIO,e.m4r=t.AUDIO,e.au=t.AUDIO,e.wav=t.AUDIO,e.yuv=t.IMAGE,e.thm=t.IMAGE,e.psdimage=t.IMAGE,e.psd=t.IMAGE,e.bmp=t.IMAGE,e.gif=t.IMAGE,e.tif=t.IMAGE,e.png=t.IMAGE,e.jpg=t.IMAGE,e.jpeg=t.IMAGE,e.csv=t.CSV,e.xlw=t.EXCEL,e.xltx=t.EXCEL,e.xltm=t.EXCEL,e.xlt=t.EXCEL,e.xlsx=t.EXCEL,e.xlsm=t.EXCEL,e.xlsb=t.EXCEL,e.xls=t.EXCEL,e.xlm=t.EXCEL,e.xll=t.EXCEL,e.xlc=t.EXCEL,e.xlb=t.EXCEL,e.xlam=t.EXCEL,e.xla=t.EXCEL,e.xl=t.EXCEL,e.xar=t.EXCEL,e.pptx=t.PPT,e.ppt=t.PPT,e.txt=t.TEXT,e.dotx=t.WORD,e.dotm=t.WORD,e.dot=t.WORD,e.docm=t.WORD,e.cnv=t.WORD,e.asd=t.WORD,e.wll=t.WORD,e.wbk=t.WORD,e.docx=t.WORD,e.doc=t.WORD,e.zip=t.ZIP,e.buy=t.BUY,e.external=t.EXTERNAL,e.key=t.KEYNOTE,e.epub=t.EPUB,e.ibooks=t.IBOOKS,e},n=function(t,n){var i=e(),o="";if(t){var r=window.location.pathname,c=r.split("/"),a=c[c.length-2]+"/"+c[c.length-1];o=r.replace(a,"").concat(t+".png")}else o="images/fileTypes/"+i[n]+"_default_thumbnail.png";return o};return{getTypes:e,getIcon:n}}]},{}],15:[function(t,e,n){"use strict";e.exports=["$timeout","$http","$q","SelectorService","ProductService","ImageService",function(t,e,n,i,o,r){function c(t,e){var n=[];return angular.forEach(t,function(t){n.push(t[e])}),n.filter(function(t,e,n){if(t)return n.indexOf(t)===e})}function a(t,e){angular.forEach(t.items,function(t){t.available=!1,angular.forEach(e.items,function(e){t.title===e.title&&(t.available=!0)})})}function s(t){function e(e){angular.forEach(e,function(e){n[e]={},n[e].items=[];var i=c(t,e);angular.forEach(i,function(i,r){var a=t.filter(function(t){return t[e]===i}),s=angular.copy(o.getProduct(i));s?(s.index=r,s.checked=!1,s.available=!0,s.products=c(a,"product"),s.applications=c(a,"application"),s.substrates=c(a,"substrate"),s.machines=c(a,"machine"),n[e].items.push(s)):console.log("product not found",i)})})}var n={};n.products={},n.products.items=[];var i=c(t,"product");angular.forEach(i,function(e,i){var o=t.filter(function(t){return t.product===e});n.products.items.push({index:i,title:e,image:r.getImage(e),order:r.getOrder(e),checked:!1,available:!0,substrates:c(o,"substrate"),applications:c(o,"application"),machines:c(o,"machine")})}),n.substrates={},n.substrates.items=[];var a=c(t,"substrate");angular.forEach(a,function(e,i){var o=t.filter(function(t){return t.substrate===e});n.substrates.items.push({index:i,title:e,image:r.getImage(e),order:r.getOrder(e),checked:!1,available:!0,products:c(o,"product"),applications:c(o,"application"),machines:c(o,"machine")})}),n.machines={},n.machines.items=[];var s=c(t,"machine");angular.forEach(s,function(e,i){var o=t.filter(function(t){return t.machine===e});n.machines.items.push({index:i,title:e,image:r.getImage(e),order:r.getOrder(e),checked:!1,available:!0,products:c(o,"product"),applications:c(o,"application"),substrates:c(o,"substrate")})}),n.applications={},n.applications.items=[];var u=c(t,"application");return angular.forEach(u,function(e,i){var o=t.filter(function(t){return t.application===e});n.applications.items.push({index:i,title:e,image:r.getImage(e),order:r.getOrder(e),checked:!1,available:!0,definition:c(o,"definition"),includes:c(o,"includes"),products:c(o,"product"),machines:c(o,"machine"),substrates:c(o,"substrate"),recommended:c(o,"recommended"),alternative:c(o,"alternative"),general:c(o,"general")})}),e(["recommended","alternative","general"]),n}var u=!1,l={};l.suggestions=[],l.choices={};var f=function(){i.getSelections(l.choices).then(function(t){var e=s(t);angular.forEach(e,function(t,n){l[n]&&a(l[n],e[n])})})},p=function(){return u},d=function(){return n(function(e){i.getSelections().then(function(n){var i=s(n);angular.forEach(i,function(t,e){l[e]=t}),t(function(){u=!0,e()})})})},m=function(t){if(angular.isArray(t)){var e={};return angular.forEach(t,function(t){e[t]=l[t]}),e}return l[t]};return{init:d,inited:p,fetch:m,update:f}}]},{}],16:[function(t,e,n){"use strict";e.exports=["$q","SQLService",function(t,e){function n(t){var e=c.items.filter(function(e){return e.title===t})[0],n=e&&e.id?e.id:"placeholder";return"images/photos/"+n+".jpg"}function i(t){return c.items.filter(function(e){return e.title===t})[0].display_order}function o(){return t(function(t,n){var i="SELECT * FROM images";e.runSQL(i).then(function(e){c.items=e[0].result,r=!0,t()},function(t){console.error(t),n(t)})})}var r=!1,c={},a=function(){return r};return{init:o,inited:a,getImage:n,getOrder:i}}]},{}],17:[function(t,e,n){"use strict";e.exports=["$templateCache","$compile","$timeout","$http","$q",function(t,e,n,i,o){var r=function(t){return o(function(e){var n=new Image;n.onload=function(){var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(this,0,0),e(t.toDataURL("image/png"))},n.src=t})},c=function(t,e){var n="<html>";return e&&(n+="<style>"+e+"</style>"),n+="<body>"+t+"</body></html>"},a=function(r,a){return o(function(o,s){if(a&&a.templatePath){var u="",l={};l=e(t.get(a.templatePath))(r),n(function(){for(var t=0;t<l.length;t++)u+=l[t].outerHTML;a.cssPath?i.get(a.cssPath).then(function(t){o(c(u,t.data.toString()))},function(t){s(t)}):o(c(u))})}else s("No template path provided")})},s=function(t,e){return o(function(n,i){a(t,e).then(function(t){var o=e&&e.title?e.title:"document";macs.getPathForConvertedPDFFileFromHTML({pageContent:encodeURI(t),generatedPDFName:o},function(t){macs.printAsset(t.filePath,function(){n()},function(t){i(t)})},function(t){i(t)})},function(t){i(t)})})},u=function(t,e,n){return o(function(i,o){a(t,n).then(function(t){var r=n&&n.title?n.title:"document";macs.getPathForConvertedPDFFileFromHTML({pageContent:encodeURI(t),generatedPDFName:r},function(t){macs.emailWithMultipleAssets({email:e,assets:t.filePath}),i()},function(t){o(t)})},function(t){o(t)})})};return{getDataURI:r,compileHTML:a,savePDF:s,emailPDF:u}}]},{}],18:[function(t,e,n){"use strict";e.exports=["$q","SQLService",function(t,e){function n(t){return r.items.filter(function(e){return e.part===t})[0]}function i(){return t(function(t,n){var i="SELECT * FROM products";e.runSQL(i).then(function(e){r.items=e[0].result,o=!0,t()},function(t){console.error(t),n(t)})})}var o=!1,r={},c=function(){return o};return{init:i,inited:c,getProduct:n}}]},{}],19:[function(t,e,n){"use strict";e.exports=["$rootScope","ConfigService","localStorageService","$q",function(t,e,n,i){function o(o){return i(function(i){function r(t){for(var e=t.length,n=new Uint8Array(e),i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}if(t.macsAlive)i();else{window.SQLService=this,h=!0,d=new Worker("scripts/loaddbworker.js"),m=new Worker("scripts/worker.sql.js");var c=n.get("sql");if(o&&c)m.postMessage({id:g,action:"open",buffer:r(c)});else{d.onmessage=function(t){m.postMessage({id:g,action:"open",buffer:t.data})};var a=e.fetch("settings"),s=a.language_code.setting,u=a.selected_db.setting,l="../data/"+u+"_"+s+".sqlite";d.postMessage({url:l})}m.onmessage=function(t){console.log(t),g++,i("Database opened")},m.onerror=function(t){i("Worker error: ",t)}}})}function r(){function t(t){for(var e=new Uint8Array(t),n=[],i=65535,o=0;o*i<e.length;o++)n.push(String.fromCharCode.apply(null,e.subarray(o*i,(o+1)*i)));return n.join("")}g++,m.postMessage({id:g,action:"export"}),m.onmessage=function(e){console.log(e),n.set("sql",t(e.data.buffer))}}function c(t){return i(function(e){function n(){c===o.length?e(r):i(o[c])}function i(t){c++;var e={assetId:v,query:t};t.indexOf("INSERT")<0&&t.indexOf("UPDATE")<0&&t.indexOf("CREATE")<0&&t.indexOf("VACUUM")<0&&t.indexOf("DELETE")<0?macs.getResultsForSqliteSelectQuery(e,function(t){r.push(t),n()},function(t){n()}):macs.executeSqliteQuery(e,function(t){n()},function(t){n()})}var o=[];angular.forEach(t.split(";"),function(t){var e=t.trim();e.length&&o.push(e)});var r=[],c=0;i(o[c])})}function a(e){return i(function(n){t.macsAlive?p(e).then(function(t){n(t)}):f(e).then(function(t){n(t)})})}function s(t){return i(function(e){g++,m.postMessage({id:g,action:"exec",sql:t}),m.onmessage=function(t){var n=[],i=t.data.results||[];i[0]&&angular.forEach(i,function(t){var e={result:[]};angular.forEach(t.values,function(n){var i={};angular.forEach(t.columns,function(t,e){i[t]=n[e]}),e.result.push(i)}),n.push(e)}),e(n)}})}function u(){var t=b[0];s(t.sql).then(function(e){b.shift(),t.deferred.resolve(e),b.length>0&&u()},function(e){b.shift(),t.deferred.reject(e),b.length>0&&u()})}function l(){var t=b[0];c(t.sql).then(function(e){b.shift(),t.deferred.resolve(e),b.length>0&&l()},function(e){b.shift(),t.deferred.reject(e),b.length>0&&l()})}function f(t){var e=i.defer();return b.push({sql:t,deferred:e}),1===b.length&&u(),e.promise}function p(t){var e=i.defer();return b.push({sql:t,deferred:e}),1===b.length&&l(),e.promise}var d,m,h=!1,g=1,v=e.params("sqlAssetId"),b=[];return{initDB:o,runSQL:a,inited:h,saveDB:r}}]},{}],20:[function(t,e,n){"use strict";e.exports=["$q","SQLService",function(t,e){function n(n){return t(function(t){var i="SELECT * FROM selector",o=0;angular.forEach(n,function(t,e){t&&(i+=o?" AND ":" WHERE ",o++,i+="("+e+' = "'+t.title+'")')}),e.runSQL(i).then(function(e){t(e[0].result)},function(e){console.error(e),t([])})})}return{getSelections:n}}]},{}],21:[function(t,e,n){"use strict";e.exports=["localStorageService",function(t){function e(){return n}var n={};return n.items=t.get("data"),n.items||(n.items={name:"",company:"",tel:"",email:""}),{getSettings:e}}]},{}]},{},[1]);